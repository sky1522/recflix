# RecFlix 데이터 전처리 및 피처 엔지니어링

**최종 업데이트**: 2026-02-10

---

## 1. 데이터 정제 과정

TMDB에서 수집한 원본 데이터를 서비스에 적합한 형태로 정제하였습니다.

### 정제 단계

| 단계 | 작업 내용 | 삭제 건수 | 잔여 건수 |
|------|-----------|-----------|-----------|
| 원본 수집 | TMDB 전체 데이터 | - | ~1,150,000 |
| 1차 추출 | 인기도 순 상위 추출 | ~1,060,000 | ~90,000 |
| 2차 필수 컬럼 필터 | 제목, 장르, 러닝타임, 줄거리, 포스터 이미지 필수 | ~40,000 | ~50,000 |
| 3차 품질 필터 | 평점·인기도·투표수 0~1 이하, 개봉 예정작, 1960년대 이전 흑백영화 삭제 | ~7,000 | ~43,000 |
| 4차 수동 정제 | 아이돌 콘서트 영상 (세븐틴, 블랙핑크, 방탄소년단) 삭제 | 3 | ~42,920 |
| 5차 성인물 정제 | `is_adult` True/False 분리, 줄거리상 성인물 내용(19+) 추가 삭제 | ~50 | **42,917** |

---

## 2. 연령 등급 분류 (Certification)

### 미국 MPAA 등급 체계

| 등급 | 명칭 | 설명 | 한국 대응 등급 |
|------|------|------|---------------|
| **G** | General Audiences | 전체 관람가. 모든 연령층이 관람 가능하며, 부모가 불쾌할 만한 내용이 거의 없음. | 전체 관람가 |
| **PG** | Parental Guidance Suggested | 부모 지도 요망. 전체 관람은 가능하나 일부 내용이 어린이에게 부적절할 수 있어 부모의 지도가 권장됨. | 전체 관람가 ~ 12세 미만 |
| **PG-13** | Parents Strongly Cautioned | 부모 주의 강요. 13세 미만 어린이에게 부적절한 내용이 포함될 수 있음. 약간의 욕설이나 폭력성 포함. | 12세 ~ 15세 이상 관람가 |
| **R** | Restricted | 제한 상영. 17세 미만은 부모나 성인 보호자 동반 시에만 관람 가능. 성인용 소재, 심한 욕설, 폭력 등이 포함됨. | 청소년 관람불가 (일부 15세) |
| **NC-17** | No One 17 and Under Admitted | 17세 이하 관람 불가. 보호자가 있어도 17세 이하는 절대 입장할 수 없음. 매우 높은 수위의 성적 묘사나 폭력을 포함. | 청소년 관람불가 ~ 제한상영가 |

### R 등급 vs NR 등급 해석

| 구분 | R 등급 | NR 등급 |
|------|--------|---------|
| 성격 | 고수위 콘텐츠 (공식 분류) | 정보 없음 또는 비주류/독립 영화 |
| 데이터 해석 | "자극적인 내용이 포함됨" | "심의를 받지 않았거나 데이터 누락" |
| 분석 시 추천 | 청불 영화 분석군으로 묶음 | '기타' 혹은 '미분류' 군으로 분리 |

---

## 3. Weighted Score (가중 평점)

### 왜 가중 평점이 필요한가?

단순히 별점 평균만 보는 것이 아니라, **"투표 참여 인원이 충분한가?"**를 수학적으로 반영하여 순위를 매기는 방식입니다. IMDB 같은 글로벌 영화 사이트에서 신뢰도 높은 랭킹을 매길 때 사용합니다.

만약 어떤 영화가 1명만 투표했는데 10점을 받았다면, 그 영화는 평점 1위가 됩니다. 하지만 10,000명이 투표해서 8.5점을 받은 영화가 훨씬 더 대중적이고 검증된 영화입니다. weighted_score는 투표수가 적은 영화의 평점은 전체 평균 쪽으로 끌어내리고, 투표수가 많을수록 영화 본래의 평점을 인정해 주는 방식입니다.

### 계산 공식

$$WS = \left(\frac{v}{v + m}\right) \times R + \left(\frac{m}{v + m}\right) \times C$$

- **v**: 해당 영화의 투표 수 (vote_count)
- **m**: 최소 투표 수 기준값
- **R**: 해당 영화의 평균 평점 (vote_average)
- **C**: 전체 영화의 평균 평점

### 공식의 의미

| 부분 | 수식 | 설명 |
|------|------|------|
| 왼쪽 | (v / (v+m)) × R | 투표 수가 커질수록 1에 가까워지며, 영화의 실제 평점이 점수에 크게 반영됨 |
| 오른쪽 | (m / (v+m)) × C | 투표 수가 적을수록 비율이 커지며, 전체 영화 평균값에 가깝게 계산됨 |

### 계산 예시

전체 평균 평점 (C) = 6.0점, 최소 투표 수 (m) = 100표 기준:

| 영화 | 평점 | 투표수 | Weighted Score | 해석 |
|------|------|--------|---------------|------|
| A 영화 | 9.0 | 5표 | 약 6.14점 | 투표수가 너무 적어 전체 평균(6점)에 가깝게 깎임 |
| B 영화 | 8.5 | 1,000표 | 약 8.27점 | 투표수가 많아 본래 평점(8.5점)에 가깝게 유지됨 |

---

## 4. TMDB 외 추가 컬럼

### 4.1 장르 데이터의 수치화 (One-Hot Encoding)

기존에는 '장르'라는 하나의 컬럼에 텍스트로 묶여 있었지만, 이를 개별 컬럼(SF, 드라마, 코미디 등)으로 분리하여 해당하면 1, 아니면 0으로 표시했습니다.

- **효과**: 머신러닝 모델이나 추천 알고리즘이 "이 영화가 액션 영화인가?"를 즉각적으로 계산할 수 있게 합니다.

### 4.2 계절 정보 추가 (release_season)

개봉일(release_date) 데이터를 바탕으로 영화가 어느 계절에 개봉했는지를 나타내는 `release_season` 컬럼이 추가되었습니다. (예: 봄, 여름, 가을, 겨울)

- **효과**: 특정 계절(예: 크리스마스 시즌의 로맨스, 여름의 공포/액션)에 따른 관객 선호도나 흥행 패턴을 분석하는 데 유용합니다.

### 4.3 신뢰도를 반영한 가중치 평점 (weighted_score)

단순히 별점이 높은 순서가 아니라, 평점(vote_average)과 투표 수(vote_count)를 결합한 산출물입니다.

- **왜 중요한가?** 1명이 10점을 준 영화보다, 1만 명이 8.5점을 준 영화가 더 '검증된 수작'임을 시스템이 이해하도록 돕습니다. (예: '쇼생크 탈출'이 높은 점수를 유지하는 이유입니다.)

### 4.4 데이터 가독성 및 현지화

- **한국어/영어 병기**: `title_ko_en`, `cast_ko`, `director_ko`, `production_countries_ko` 등 주요 정보를 한국어로 함께 정리하여 국내 사용자 타겟 서비스에 최적화하였습니다.
- **유사 영화 정보**: `similar_movies` 및 `similar_movie_ids`를 포함하여, 특정 영화와 연결된 콘텐츠 흐름을 미리 파악해 두었습니다.

---

## 5. 주요 컬럼 요약

| 구분 | 컬럼명 (예시) | 설명 |
|------|--------------|------|
| 분석용 가공 | `weighted_score` | 투표 수와 평점을 고려한 신뢰 기반 점수 |
| 시간 데이터 | `release_season` | 개봉일 기준 계절 정보 (봄, 여름, 가을, 겨울) |
| 특성 추출 | SF, 액션, 코미디 등 | 각 장르 포함 여부를 0과 1로 구분 |
| 언어 최적화 | `cast_ko`, `director_ko` | 한국어 사용자 친화적인 번역 데이터 |
| 연령 등급 | `certification` | MPAA 기반 연령 등급 (G, PG, PG-13, R, NC-17) |
| 유사 영화 | `similar_movies`, `similar_movie_ids` | TMDB 기반 유사 영화 연결 정보 |

---

## 6. 최종 데이터셋 통계

| 항목 | 수치 |
|------|------|
| 전체 영화 수 | 42,917편 |
| 기간 | 2010년 ~ 현재 |
| 컬럼 수 | 43개 |
| 평균 평점 (vote_average) | 6.31 |
| 평균 상영시간 (runtime) | 104분 |
| 평균 가중평점 (weighted_score) | 6.36 |
| 장르 수 | 19개 |
| 연령등급 보유율 | 44.4% (나머지 NULL) |